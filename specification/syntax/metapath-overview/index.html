<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><script type=text/javascript src=/module/hugo-uswds/js/uswds-init.min.js></script><link rel=preload href=/module/hugo-uswds/js/uswds.min.js as=script><link rel=stylesheet href=/module/hugo-uswds/css/styles.css><title>Metapath vs. XPath 3.1: Key Differences</title>
<script type=text/javascript src=/module/hugo-uswds/js/jquery.min.js></script><script type=text/javascript defer src=/module/hugo-uswds/js/hugo-uswds.min.js></script></head><body><div class=usa-overlay></div><header class="usa-header usa-header--extended site-header"><div class="usa-navbar site-header__navbar"><div id=extended-logo class="usa-logo site-logo"><a class="usa-logo__text site-logo__text" href=/ title="Metaschema Information Modeling Framework" aria-label=Home><em><span class=site-title--short>Metaschema</span>
<span class=site-title--long>Metaschema Information Modeling Framework</span></em></a></div><div class="site-nav-secondary usa-nav__secondary"><ul class=usa-nav__secondary-links><li class=usa-nav__secondary-item><a href=/contribute/contact/>Contact Us</a></li><li class=usa-nav__secondary-item><a href=/contribute/>Get involved</a></li><li class=usa-nav__secondary-item><a href=https://github.com/metaschema-framework/metaschema>Github</a></li></ul><section aria-label="Search component"><form class="usa-search usa-search--small" role=search action=https://search.usa.gov/search><input id=affiliate name=affiliate type=hidden>
<input name=utf8 type=hidden value=&#x2713;>
<label class=usa-sr-only for=search-field-en-small>Search</label>
<input class=usa-input id=search-field-en-small type=search name=query>
<button class=usa-button type=submit><img src=/module/hugo-uswds/img/usa-icons-bg/search--white.svg class=usa-search__submit-icon alt=Search></button></form></section></div><button class=usa-menu-btn>Menu</button></div></header><nav class="site-nav usa-nav sticky" aria-label="Primary navigation"><div class="usa-nav__inner site-nav__inner"><button class=usa-nav__close><img src=/module/hugo-uswds/img/usa-icons/close.svg role=img alt=close></button><ul class="usa-nav__primary usa-accordion"><li class=usa-nav__primary-item><a class=usa-nav__link href=/specification/><span>Specification</span></a></li><li class=usa-nav__primary-item><a class=usa-nav__link href=/tutorials/><span>Tutorials</span></a></li><li class=usa-nav__primary-item><a class=usa-nav__link href=/use/><span>Using</span></a></li><li class=usa-nav__primary-item><a class=usa-nav__link href=/contribute/><span>Contribute</span></a></li></ul></div></nav><div class=site-content-container><aside id=page-side-navigation class="sidenav site-sidenav" aria-label="Section navigation"><nav aria-label="Secondary navigation"><ul class=usa-sidenav><li class="usa-sidenav__item section usa-subnav__top-level"><a href=/specification/>Metaschema Specification</a><ul class=usa-sidenav__sublist><li class="usa-sidenav__item page"><a href=/specification/overview/>Overview</a></li><li class="usa-sidenav__item page"><a href=/specification/information-modeling/>Information Modeling</a></li><li class="usa-sidenav__item section"><a href=/specification/syntax/>Syntax</a><ul class=usa-sidenav__sublist><li class="usa-sidenav__item page"><a href=/specification/syntax/module/>Module</a></li><li class="usa-sidenav__item page"><a href=/specification/syntax/definitions/>Definitions</a></li><li class="usa-sidenav__item page"><a href=/specification/syntax/instances/>Instances</a></li><li class="usa-sidenav__item page"><a href=/specification/syntax/inline-definitions/>Inline Definitions</a></li><li class="usa-sidenav__item page"><a href=/specification/syntax/constraints/>Constraints</a></li><li class="usa-sidenav__item page"><a href=/specification/syntax/metapath/>Metapath Expression Language</a></li><li class="usa-sidenav__item page"><a class=usa-current href=/specification/syntax/metapath-overview/>Metapath vs. XPath</a></li></ul></li><li class="usa-sidenav__item page"><a href=/specification/mapping/>Format Bindings</a></li><li class="usa-sidenav__item page"><a href=/specification/datatypes/>Data Types</a></li><li class="usa-sidenav__item page"><a href=/specification/glossary/>Glossary</a></li></ul></li></ul></nav></aside><div class=usa-in-page-nav-container><aside class=site-in-page-nav aria-label="On this page" data-heading-selectors="h2, h3, h4, h5, h6" data-scroll-offset=-120 data-root-margin="48px 0px -90% 0px" data-threshold=1><nav class=usa-in-page-nav__nav aria-label="On this page"><h4 class=usa-in-page-nav__heading tabindex=0>On this page</h4><ul class=usa-in-page-nav__list><li class=usa-in-page-nav__item><a href=#overview class="site-in-page-nav__link h2">Overview</a></li><li class=usa-in-page-nav__item><a href=#1-format-agnosticism class="site-in-page-nav__link h2">1. Format Agnosticism</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#xpath-31 class="site-in-page-nav__link h3">XPath 3.1</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#metapath class="site-in-page-nav__link h3">Metapath</a></li><li class=usa-in-page-nav__item><a href=#2-fundamental-data-model-differences class="site-in-page-nav__link h2">2. Fundamental Data Model Differences</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#xpath-31-data-model class="site-in-page-nav__link h3">XPath 3.1 Data Model</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#metapath-data-model class="site-in-page-nav__link h3">Metapath Data Model</a></li><li class=usa-in-page-nav__item><a href=#3-node-selection-and-addressing class="site-in-page-nav__link h2">3. Node Selection and Addressing</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#xpath-31-approach class="site-in-page-nav__link h3">XPath 3.1 Approach</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#metapath-approach class="site-in-page-nav__link h3">Metapath Approach</a></li><li class=usa-in-page-nav__item><a href=#4-function-library class="site-in-page-nav__link h2">4. Function Library</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#xpath-31-1 class="site-in-page-nav__link h3">XPath 3.1</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#metapath-1 class="site-in-page-nav__link h3">Metapath</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#core-functions-fn class="site-in-page-nav__link h4">Core Functions (<code>fn:</code>)</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#array-functions-array class="site-in-page-nav__link h4">Array Functions (<code>array:</code>)</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#map-functions-map class="site-in-page-nav__link h4">Map Functions (<code>map:</code>)</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#metapath-specific-functions-mp class="site-in-page-nav__link h4">Metapath-Specific Functions (<code>mp:</code>)</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#cast-functions class="site-in-page-nav__link h4">Cast Functions</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#functions-marked-for-future-implementation class="site-in-page-nav__link h4">Functions Marked for Future Implementation</a></li><li class=usa-in-page-nav__item><a href=#5-variable-binding class="site-in-page-nav__link h2">5. Variable Binding</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#xpath-31-2 class="site-in-page-nav__link h3">XPath 3.1</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#metapath-2 class="site-in-page-nav__link h3">Metapath</a></li><li class=usa-in-page-nav__item><a href=#6-xpath-31-feature-support-in-metapath class="site-in-page-nav__link h2">6. XPath 3.1 Feature Support in Metapath</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#fully-supported-xpath-31-features class="site-in-page-nav__link h3">Fully Supported XPath 3.1 Features</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#supported-axes class="site-in-page-nav__link h3">Supported Axes</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#features-not-supported-data-model-differences class="site-in-page-nav__link h3">Features Not Supported (Data Model Differences)</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#metapath-specific-extensions class="site-in-page-nav__link h3">Metapath-Specific Extensions</a></li><li class=usa-in-page-nav__item><a href=#7-constraint-integration class="site-in-page-nav__link h2">7. Constraint Integration</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#xpath-31-3 class="site-in-page-nav__link h3">XPath 3.1</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#metapath-3 class="site-in-page-nav__link h3">Metapath</a></li><li class=usa-in-page-nav__item><a href=#8-evaluation-context-differences class="site-in-page-nav__link h2">8. Evaluation Context Differences</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#xpath-31-4 class="site-in-page-nav__link h3">XPath 3.1</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#metapath-4 class="site-in-page-nav__link h3">Metapath</a></li><li class=usa-in-page-nav__item><a href=#9-type-system class="site-in-page-nav__link h2">9. Type System</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#xpath-31-5 class="site-in-page-nav__link h3">XPath 3.1</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#metapath-5 class="site-in-page-nav__link h3">Metapath</a></li><li class=usa-in-page-nav__item><a href=#10-implementation class="site-in-page-nav__link h2">10. Implementation</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#grammar class="site-in-page-nav__link h3">Grammar</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#available-implementations class="site-in-page-nav__link h3">Available Implementations</a></li><li class=usa-in-page-nav__item><a href=#summary-comparison-table class="site-in-page-nav__link h2">Summary Comparison Table</a></li><li class=usa-in-page-nav__item><a href=#references class="site-in-page-nav__link h2">References</a></li></ul></nav></aside><main id=main-content class="main-content usa-prose"><header><nav class=usa-breadcrumb aria-label=Breadcrumbs><ol class=usa-breadcrumb__list><li class=usa-breadcrumb__list-item><a href=/specification/ class=usa-breadcrumb__link><span>Metaschema Specification</span></a></li><li class=usa-breadcrumb__list-item><a href=/specification/syntax/ class=usa-breadcrumb__link><span>Syntax</span></a></li><li class="usa-breadcrumb__list-item usa-current"><a href=/specification/syntax/metapath-overview/ class=usa-breadcrumb__link aria-current=page><span>Metapath vs. XPath</span></a></li></ol></nav></header><h1 id=metapath-vs-xpath-31-key-differences><a href=#metapath-vs-xpath-31-key-differences>Metapath vs. XPath 3.1: Key Differences</a></h1><h2 id=overview><a href=#overview>Overview</a></h2><p><strong>Metapath</strong> is an expression language that is part of the Metaschema Information Modeling Framework. While Metapath is explicitly described as &ldquo;a customization of the <a href=https://www.w3.org/TR/2017/REC-xpath-31-20170321/ rel=external>XML Path Language (XPath) 3.1</a>, which has been adjusted to work with a Metaschema module-based model&rdquo; (<a href=../metapath/>Metapath Specification</a>), there are significant differences between the two languages.</p><p>The Metapath specification notes: &ldquo;Not all XPath features are supported by Metapath, the specifics of which will be documented in an updated version of this page in the future&rdquo; (<a href=../metapath/>Metapath Specification</a>).</p><hr><h2 id=1-format-agnosticism><a href=#1-format-agnosticism>1. Format Agnosticism</a></h2><h3 id=xpath-31><a href=#xpath-31>XPath 3.1</a></h3><p>XPath 3.1 is inherently tied to XML. While implementations may work with JSON through conversion, XPath itself assumes XML document structure.</p><h3 id=metapath><a href=#metapath>Metapath</a></h3><p>Metapath is designed to be <strong>format-agnostic</strong> and can query:</p><ul><li>XML</li><li>JSON</li><li>YAML</li></ul><p>As stated in the specification: &ldquo;A Metapath can be used to query all Metaschema-supported formats (i.e., JSON, YAML, XML) using a common, Metaschema module-bound syntax. This means a Metapath can be used to query the same data regardless of the underlying format used, as long as that data is bound to a Metaschema module&rdquo; (<a href=../metapath/>Metapath Specification</a>).</p><p>This format agnosticism was a primary design goal, as other path languages like JSON Path and JSON Pointer &ldquo;were not chosen, due to limitations in <em>evaluation</em> capabilities and because their syntax was specific to JSON&rdquo; (<a href=../metapath/>Metapath Specification</a>).</p><hr><h2 id=2-fundamental-data-model-differences><a href=#2-fundamental-data-model-differences>2. Fundamental Data Model Differences</a></h2><h3 id=xpath-31-data-model><a href=#xpath-31-data-model>XPath 3.1 Data Model</a></h3><p>XPath 3.1 operates on the <a href=https://www.w3.org/TR/xpath-datamodel-31/ rel=external>XML Data Model (XDM) 3.1</a>, which exposes seven kinds of nodes:</p><ul><li><strong>Document nodes</strong> (root)</li><li><strong>Element nodes</strong></li><li><strong>Attribute nodes</strong></li><li><strong>Text nodes</strong></li><li><strong>Comment nodes</strong></li><li><strong>Processing instruction nodes</strong></li><li><strong>Namespace nodes</strong></li></ul><h3 id=metapath-data-model><a href=#metapath-data-model>Metapath Data Model</a></h3><p>Metapath replaces the XML Data Model with the <strong>Metaschema data model</strong>, which exposes three primary node types:</p><table><thead><tr><th>Metapath Node Type</th><th>Description</th><th>XPath Nearest Equivalent</th></tr></thead><tbody><tr><td><strong>Flag</strong></td><td>Simple, named information element with a value; leaf nodes used for identifying/qualifying information</td><td>Attribute (<code>@</code>)</td></tr><tr><td><strong>Field</strong></td><td>Complex named information element with a value and optional flag instances; edge nodes</td><td>Element with text content</td></tr><tr><td><strong>Assembly</strong></td><td>Complex composite information element with no value of its own; contains flags and a model of fields/assemblies</td><td>Element with child elements</td></tr></tbody></table><p><strong>Key Distinction</strong>: In Metapath, there is no equivalent to XPath&rsquo;s text nodes, comment nodes, processing instruction nodes, or namespace nodes. The data model is designed around the Metaschema module constructs rather than XML serialization details.</p><p><strong>Reference</strong>: <a href=/specification/information-modeling/>Information Modeling Specification</a></p><hr><h2 id=3-node-selection-and-addressing><a href=#3-node-selection-and-addressing>3. Node Selection and Addressing</a></h2><h3 id=xpath-31-approach><a href=#xpath-31-approach>XPath 3.1 Approach</a></h3><p>XPath uses axes (child, parent, ancestor, descendant, attribute, etc.) to navigate the XML tree. Attributes are accessed using the <code>@</code> prefix.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>/catalog/book/@isbn
</span></span><span class=line><span class=cl>//book/title
</span></span><span class=line><span class=cl>../sibling-element
</span></span></code></pre></div><h3 id=metapath-approach><a href=#metapath-approach>Metapath Approach</a></h3><p>Metapath paths reference Metaschema model constructs directly:</p><ul><li><strong>Flags are accessed using the <code>@</code> prefix</strong>, mirroring XPath&rsquo;s attribute syntax</li><li>Fields and assemblies are accessed as path steps (similar to XPath element navigation)</li><li>Navigation is through the Metaschema module&rsquo;s defined model structure</li><li>The current context (<code>.</code>) refers to a flag, field, or assembly node</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=o>.</span>                    <span class=p>(</span><span class=n>current</span> <span class=n>node</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>..</span>                   <span class=p>(</span><span class=n>parent</span> <span class=n>node</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=err>@</span><span class=n>flag</span><span class=o>-</span><span class=n>name</span>           <span class=p>(</span><span class=n>flag</span> <span class=n>on</span> <span class=n>current</span> <span class=n>node</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>child</span><span class=o>-</span><span class=n>field</span>          <span class=p>(</span><span class=n>child</span> <span class=n>field</span> <span class=ow>or</span> <span class=n>assembly</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>$</span><span class=n>parent</span><span class=o>/</span><span class=n>sibling</span>      <span class=p>(</span><span class=n>variable</span> <span class=n>reference</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>parent</span><span class=o>/</span><span class=err>@</span><span class=n>id</span>           <span class=p>(</span><span class=n>flag</span> <span class=s1>&#39;id&#39;</span> <span class=n>on</span> <span class=s1>&#39;parent&#39;</span> <span class=n>node</span><span class=p>)</span>
</span></span></code></pre></div><p><strong>Reference</strong>: <a href=../constraints/#target>Constraints Specification - Target</a></p><hr><h2 id=4-function-library><a href=#4-function-library>4. Function Library</a></h2><h3 id=xpath-31-1><a href=#xpath-31-1>XPath 3.1</a></h3><p>XPath 3.1 includes over 200 built-in functions organized in namespaces including <code>fn:</code>, <code>math:</code>, <code>map:</code>, and <code>array:</code>. See <a href=https://www.w3.org/TR/xpath-functions-31/ rel=external>XPath and XQuery Functions and Operators 3.1</a>.</p><h3 id=metapath-1><a href=#metapath-1>Metapath</a></h3><p>Metapath implements a substantial subset of XPath 3.1 functions plus custom extensions. Based on <a href=https://github.com/metaschema-framework/metaschema-java/blob/develop/core/src/main/java/gov/nist/secauto/metaschema/core/metapath/function/library/DefaultFunctionLibrary.java rel=external>DefaultFunctionLibrary.java</a> is the manifest of all implemented and planned to be implemented functions for <a href=https://github.com/metaschema-framework/metaschema-java rel=external>the reference implementation</a>. Below is an overview of these functions, categorized thematically into their capabilities.</p><h4 id=core-functions-fn><a href=#core-functions-fn>Core Functions (<code>fn:</code>)</a></h4><p><strong>Boolean Functions:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-true rel=external><code>true()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-false rel=external><code>false()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-not rel=external><code>not()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-boolean rel=external><code>boolean()</code></a></li></ul><p><strong>Numeric Functions:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-abs rel=external><code>abs()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-ceiling rel=external><code>ceiling()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-floor rel=external><code>floor()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-round rel=external><code>round()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-avg rel=external><code>avg()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-count rel=external><code>count()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-max rel=external><code>max()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-min rel=external><code>min()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-sum rel=external><code>sum()</code></a></li></ul><p><strong>String Functions:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-compare rel=external><code>compare()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-concat rel=external><code>concat()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-contains rel=external><code>contains()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-starts-with rel=external><code>starts-with()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-ends-with rel=external><code>ends-with()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-lower-case rel=external><code>lower-case()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-upper-case rel=external><code>upper-case()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-normalize-space rel=external><code>normalize-space()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-string rel=external><code>string()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-string-length rel=external><code>string-length()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-string-join rel=external><code>string-join()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-substring rel=external><code>substring()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-substring-after rel=external><code>substring-after()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-substring-before rel=external><code>substring-before()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-matches rel=external><code>matches()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-tokenize rel=external><code>tokenize()</code></a></li></ul><p><strong>Sequence Functions:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-empty rel=external><code>empty()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-exists rel=external><code>exists()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-head rel=external><code>head()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-tail rel=external><code>tail()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-reverse rel=external><code>reverse()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-distinct-values rel=external><code>distinct-values()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-index-of rel=external><code>index-of()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-insert-before rel=external><code>insert-before()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-remove rel=external><code>remove()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-zero-or-one rel=external><code>zero-or-one()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-one-or-more rel=external><code>one-or-more()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-exactly-one rel=external><code>exactly-one()</code></a></li></ul><p><strong>Node Functions:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-data rel=external><code>data()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-path rel=external><code>path()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-root rel=external><code>root()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-local-name rel=external><code>local-name()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-name rel=external><code>name()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-namespace-uri rel=external><code>namespace-uri()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-has-children rel=external><code>has-children()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-innermost rel=external><code>innermost()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-outermost rel=external><code>outermost()</code></a></li></ul><p><strong>URI Functions:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-base-uri rel=external><code>base-uri()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-document-uri rel=external><code>document-uri()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-static-base-uri rel=external><code>static-base-uri()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-resolve-uri rel=external><code>resolve-uri()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-QName rel=external><code>QName()</code></a></li></ul><p><strong>Document Functions:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-doc rel=external><code>doc()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-doc-available rel=external><code>doc-available()</code></a></li></ul><p><strong>Date/Time Functions:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-current-date rel=external><code>current-date()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-current-dateTime rel=external><code>current-dateTime()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-current-time rel=external><code>current-time()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-dateTime rel=external><code>dateTime()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-implicit-timezone rel=external><code>implicit-timezone()</code></a></li></ul><p><strong>Date/Time Component Extraction:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-year-from-date rel=external><code>year-from-date()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-year-from-dateTime rel=external><code>year-from-dateTime()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-month-from-date rel=external><code>month-from-date()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-month-from-dateTime rel=external><code>month-from-dateTime()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-day-from-date rel=external><code>day-from-date()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-day-from-dateTime rel=external><code>day-from-dateTime()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-hours-from-dateTime rel=external><code>hours-from-dateTime()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-hours-from-time rel=external><code>hours-from-time()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-minutes-from-dateTime rel=external><code>minutes-from-dateTime()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-minutes-from-time rel=external><code>minutes-from-time()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-seconds-from-dateTime rel=external><code>seconds-from-dateTime()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-seconds-from-time rel=external><code>seconds-from-time()</code></a></li></ul><p><strong>Duration Component Extraction:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-years-from-duration rel=external><code>years-from-duration()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-months-from-duration rel=external><code>months-from-duration()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-days-from-duration rel=external><code>days-from-duration()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-hours-from-duration rel=external><code>hours-from-duration()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-minutes-from-duration rel=external><code>minutes-from-duration()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-seconds-from-duration rel=external><code>seconds-from-duration()</code></a></li></ul><p><strong>Timezone Functions:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-adjust-dateTime-to-timezone rel=external><code>adjust-dateTime-to-timezone()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-adjust-date-to-timezone rel=external><code>adjust-date-to-timezone()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-adjust-time-to-timezone rel=external><code>adjust-time-to-timezone()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-timezone-from-date rel=external><code>timezone-from-date()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-timezone-from-dateTime rel=external><code>timezone-from-dateTime()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-timezone-from-time rel=external><code>timezone-from-time()</code></a></li></ul><p><strong>Comparison Functions:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-deep-equal rel=external><code>deep-equal()</code></a></li></ul><p><strong>Higher-Order Functions:</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-function-arity rel=external><code>function-arity()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-function-lookup rel=external><code>function-lookup()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-function-name rel=external><code>function-name()</code></a></li></ul><h4 id=array-functions-array><a href=#array-functions-array>Array Functions (<code>array:</code>)</a></h4><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-get rel=external><code>array:get()</code></a> - Get member at index</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-size rel=external><code>array:size()</code></a> - Get array size</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-put rel=external><code>array:put()</code></a> - Replace member at index</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-append rel=external><code>array:append()</code></a> - Append member</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-subarray rel=external><code>array:subarray()</code></a> - Extract subarray</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-remove rel=external><code>array:remove()</code></a> - Remove member at index</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-insert-before rel=external><code>array:insert-before()</code></a> - Insert member before index</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-head rel=external><code>array:head()</code></a> - Get first member</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-tail rel=external><code>array:tail()</code></a> - Get all but first member</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-reverse rel=external><code>array:reverse()</code></a> - Reverse array</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-join rel=external><code>array:join()</code></a> - Concatenate arrays</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-flatten rel=external><code>array:flatten()</code></a> - Flatten nested arrays</li></ul><h4 id=map-functions-map><a href=#map-functions-map>Map Functions (<code>map:</code>)</a></h4><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-map-merge rel=external><code>map:merge()</code></a> - Merge maps</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-map-size rel=external><code>map:size()</code></a> - Get map size</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-map-keys rel=external><code>map:keys()</code></a> - Get all keys</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-map-contains rel=external><code>map:contains()</code></a> - Check if key exists</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-map-get rel=external><code>map:get()</code></a> - Get value for key</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-map-find rel=external><code>map:find()</code></a> - Find values for key recursively</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-map-put rel=external><code>map:put()</code></a> - Add/update entry</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-map-entry rel=external><code>map:entry()</code></a> - Create single-entry map</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-map-remove rel=external><code>map:remove()</code></a> - Remove entry</li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-map-for-each rel=external><code>map:for-each()</code></a> - Apply function to each entry</li></ul><h4 id=metapath-specific-functions-mp><a href=#metapath-specific-functions-mp>Metapath-Specific Functions (<code>mp:</code>)</a></h4><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>mp:recurse-depth()</code></td><td>Recursive resolution of linked documents</td></tr><tr><td><code>mp:base64-decode()</code></td><td>Decode base64 content</td></tr><tr><td><code>mp:base64-encode()</code></td><td>Encode to base64</td></tr></tbody></table><h4 id=cast-functions><a href=#cast-functions>Cast Functions</a></h4><p>Metapath automatically generates cast functions for all Metaschema data types (e.g., <code>xs:string()</code>, <code>xs:integer()</code>, <code>xs:boolean()</code>, etc.).</p><h4 id=functions-marked-for-future-implementation><a href=#functions-marked-for-future-implementation>Functions Marked for Future Implementation</a></h4><p>The source code indicates these XPath 3.1 functions are planned but not yet implemented:</p><p><strong>P1 (Priority 1):</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-generate-id rel=external><code>generate-id()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-last rel=external><code>last()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-replace rel=external><code>replace()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-round-half-to-even rel=external><code>round-half-to-even()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-subsequence rel=external><code>subsequence()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-translate rel=external><code>translate()</code></a></li></ul><p><strong>P2 (Priority 2):</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-format-date rel=external><code>format-date()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-format-dateTime rel=external><code>format-dateTime()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-format-integer rel=external><code>format-integer()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-format-number rel=external><code>format-number()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-format-time rel=external><code>format-time()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-position rel=external><code>position()</code></a></li></ul><p><strong>P3 (Priority 3):</strong></p><ul><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-for-each rel=external><code>array:for-each()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-array-filter rel=external><code>array:filter()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-fold-left rel=external><code>array:fold-left()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-array-fold-right rel=external><code>array:fold-right()</code></a></li><li><a href=https://www.w3.org/TR/xpath-functions-31/#func-array-for-each-pair rel=external><code>array:for-each-pair()</code></a>, <a href=https://www.w3.org/TR/xpath-functions-31/#func-array-sort rel=external><code>array:sort()</code></a></li></ul><p><strong>Namespace URIs</strong>:</p><ul><li>XPath Functions namespace: <code>http://www.w3.org/2005/xpath-functions</code></li><li>Metapath namespace: <code>http://csrc.nist.gov/ns/metaschema/metapath</code> (prefix: <code>mp</code>)</li></ul><p><em>Reference: <a href=https://github.com/metaschema-framework/metaschema-java/blob/develop/core/src/main/java/gov/nist/secauto/metaschema/core/metapath/function/library/DefaultFunctionLibrary.java rel=external>DefaultFunctionLibrary.java</a></em></p><hr><h2 id=5-variable-binding><a href=#5-variable-binding>5. Variable Binding</a></h2><h3 id=xpath-31-2><a href=#xpath-31-2>XPath 3.1</a></h3><p>XPath 3.1 supports <code>let</code> expressions for variable binding:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>let $x := /catalog/book return $x/title
</span></span></code></pre></div><h3 id=metapath-2><a href=#metapath-2>Metapath</a></h3><p>Metapath supports variable binding in two ways:</p><ol><li><strong>Programmatically</strong> - Variables can be bound through the Metapath API when executing expressions</li><li><strong>Using <code>let</code> statements</strong> - Within the Metaschema constraint model via the <code>&lt;let></code> assembly</li></ol><p><strong>Example using <code>let</code> in constraints:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;constraint&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;let</span> <span class=na>var=</span><span class=s>&#34;parent&#34;</span> <span class=na>expression=</span><span class=s>&#34;..&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;let</span> <span class=na>var=</span><span class=s>&#34;sibling-count&#34;</span> <span class=na>expression=</span><span class=s>&#34;count($parent/sibling)&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;expect</span> <span class=na>target=</span><span class=s>&#34;.&#34;</span> <span class=na>test=</span><span class=s>&#34;$sibling-count = 3&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/constraint&gt;</span>
</span></span></code></pre></div><p><strong>Key behaviors</strong>:</p><ul><li>Variables are evaluated in encounter order</li><li>If a previous variable is bound with the same name, the new value is bound in a sub-context to avoid side effects</li><li>The sub-context is available to subsequent constraints and child node constraints</li></ul><p><strong>Reference</strong>: <a href=../constraints/#let-expressions>Let Expressions Specification</a></p><hr><h2 id=6-xpath-31-feature-support-in-metapath><a href=#6-xpath-31-feature-support-in-metapath>6. XPath 3.1 Feature Support in Metapath</a></h2><p>Metapath supports most XPath 3.1 expression features. Based on the <a href=https://github.com/metaschema-framework/metaschema-java/blob/develop/core/src/main/antlr4/Metapath10.g4 rel=external>Metapath10.g4 grammar</a>:</p><h3 id=fully-supported-xpath-31-features><a href=#fully-supported-xpath-31-features>Fully Supported XPath 3.1 Features</a></h3><table><thead><tr><th>Feature Category</th><th>Supported Features</th></tr></thead><tbody><tr><td><strong>Expressions</strong></td><td><code>for</code>, <code>let</code>, <code>some</code>/<code>every</code> (quantified), <code>if</code>/<code>then</code>/<code>else</code></td></tr><tr><td><strong>Logical</strong></td><td><code>or</code>, <code>and</code></td></tr><tr><td><strong>Comparison</strong></td><td>General (<code>=</code>, <code>!=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>></code>, <code>>=</code>) and Value (<code>eq</code>, <code>ne</code>, <code>lt</code>, <code>le</code>, <code>gt</code>, <code>ge</code>)</td></tr><tr><td><strong>Arithmetic</strong></td><td><code>+</code>, <code>-</code>, <code>*</code>, <code>div</code>, <code>idiv</code>, <code>mod</code>, unary <code>+</code>/<code>-</code></td></tr><tr><td><strong>String</strong></td><td>Concatenation operator (<code>||</code>)</td></tr><tr><td><strong>Sequences</strong></td><td>Range (<code>to</code>), union (<code>|</code>, <code>union</code>), <code>intersect</code>, <code>except</code></td></tr><tr><td><strong>Type</strong></td><td><code>instance of</code>, <code>treat as</code>, <code>cast as</code>, <code>castable as</code></td></tr><tr><td><strong>Operators</strong></td><td>Arrow (<code>=></code>), Simple map (<code>!</code>)</td></tr><tr><td><strong>Constructors</strong></td><td>Arrays (square <code>[]</code> and curly <code>array {}</code>), Maps (<code>map {}</code>)</td></tr><tr><td><strong>Functions</strong></td><td>Static calls, named function references (<code>#</code>), inline functions</td></tr><tr><td><strong>Lookups</strong></td><td>Postfix lookup, unary lookup (<code>?</code>)</td></tr><tr><td><strong>Path</strong></td><td>Absolute (<code>/</code>, <code>//</code>), relative paths, predicates</td></tr></tbody></table><h3 id=supported-axes><a href=#supported-axes>Supported Axes</a></h3><p><strong>Forward axes:</strong></p><ul><li><code>child::</code>, <code>descendant::</code>, <code>self::</code>, <code>descendant-or-self::</code></li><li><code>following-sibling::</code>, <code>following::</code></li><li><code>flag::</code> <em>(Metapath-specific for accessing flags)</em></li></ul><p><strong>Reverse axes:</strong></p><ul><li><code>parent::</code>, <code>ancestor::</code>, <code>ancestor-or-self::</code></li><li><code>preceding-sibling::</code>, <code>preceding::</code></li></ul><p><strong>Abbreviated syntax:</strong></p><ul><li><code>.</code> (context item), <code>..</code> (parent), <code>@</code> (flag/attribute), <code>//</code> (descendant-or-self)</li></ul><h3 id=features-not-supported-data-model-differences><a href=#features-not-supported-data-model-differences>Features Not Supported (Data Model Differences)</a></h3><table><thead><tr><th>XPath 3.1 Feature</th><th>Reason</th></tr></thead><tbody><tr><td>Node comparisons (<code>is</code>, <code>&lt;&lt;</code>, <code>>></code>)</td><td>Commented out in grammar; not applicable to Metaschema model</td></tr><tr><td><code>namespace::</code> axis</td><td>No namespace nodes in Metaschema model</td></tr><tr><td><code>comment()</code> test</td><td>No comment nodes in Metaschema model</td></tr><tr><td><code>processing-instruction()</code> test</td><td>No PI nodes in Metaschema model</td></tr><tr><td><code>namespace-node()</code> test</td><td>No namespace nodes in Metaschema model</td></tr><tr><td><code>text()</code> test</td><td>Text is represented as field/flag values, not separate nodes</td></tr><tr><td><code>schema-element()</code>, <code>schema-attribute()</code> tests</td><td>Not applicable to Metaschema model</td></tr></tbody></table><h3 id=metapath-specific-extensions><a href=#metapath-specific-extensions>Metapath-Specific Extensions</a></h3><table><thead><tr><th>Feature</th><th>Description</th></tr></thead><tbody><tr><td><code>flag::</code> axis</td><td>Dedicated axis for navigating to flag nodes</td></tr><tr><td><code>flag()</code> kind test</td><td>Test for flag nodes</td></tr><tr><td><code>field()</code> kind test</td><td>Test for field nodes</td></tr><tr><td><code>assembly()</code> kind test</td><td>Test for assembly nodes</td></tr></tbody></table><p><em>Reference: The grammar is derived from the <a href=https://github.com/antlr/grammars-v4/blob/63359bd91593ece31a384acd507ae860d6cf7ff7/xpath/xpath31/XPath31Parser.g4 rel=external>XPath 3.1 grammar by Ken Domino et al.</a> with modifications for the Metaschema data model.</em></p><hr><h2 id=7-constraint-integration><a href=#7-constraint-integration>7. Constraint Integration</a></h2><h3 id=xpath-31-3><a href=#xpath-31-3>XPath 3.1</a></h3><p>XPath expressions can be used with XSLT, XQuery, or Schematron for validation, but this requires additional tooling.</p><h3 id=metapath-3><a href=#metapath-3>Metapath</a></h3><p>Metapath is natively integrated with Metaschema&rsquo;s <strong>constraint system</strong>. Constraints are first-class citizens:</p><ul><li><code>allowed-values</code> - Enumerated value restrictions</li><li><code>expect</code> - Boolean test expressions</li><li><code>has-cardinality</code> - Occurrence count validation</li><li><code>index</code> - Create addressable indexes</li><li><code>index-has-key</code> - Cross-reference validation</li><li><code>is-unique</code> - Uniqueness validation</li><li><code>matches</code> - Datatype and regex validation</li></ul><p><strong>Reference</strong>: <a href=../constraints/>Constraints Specification</a></p><hr><h2 id=8-evaluation-context-differences><a href=#8-evaluation-context-differences>8. Evaluation Context Differences</a></h2><h3 id=xpath-31-4><a href=#xpath-31-4>XPath 3.1</a></h3><p>The evaluation context includes:</p><ul><li>Static context (namespaces, variable declarations, function signatures)</li><li>Dynamic context (context item, position, size, variable values, current date/time)</li><li>Focus (context item, context position, context size)</li></ul><h3 id=metapath-4><a href=#metapath-4>Metapath</a></h3><p>The evaluation context is tied to the <strong>Metaschema module</strong>:</p><ul><li>The <strong>evaluation focus</strong> is the content node being processed</li><li>Constraints are evaluated against content nodes associated with definitions</li><li>Variables can be bound through <code>let</code> expressions in the constraint context</li></ul><p><strong>Key Point</strong>: &ldquo;A constraint is defined relative to an assembly, field, or flag definition in a Metaschema module. All constraints associated with a definition MUST be evaluated against all associated content nodes&rdquo; (<a href=../constraints/#constraint-processing>Constraints Processing</a>).</p><hr><h2 id=9-type-system><a href=#9-type-system>9. Type System</a></h2><h3 id=xpath-31-5><a href=#xpath-31-5>XPath 3.1</a></h3><p>Uses XSD (XML Schema Definition) types and the XDM type hierarchy, including atomic types, node types, and function types.</p><h3 id=metapath-5><a href=#metapath-5>Metapath</a></h3><p>Uses <a href=/specification/datatypes/>Metaschema data types</a>, which include:</p><p><strong>Simple types:</strong></p><ul><li><code>string</code>, <code>token</code>, <code>uri</code>, <code>uri-reference</code>, <code>uuid</code></li><li><code>decimal</code>, <code>integer</code>, <code>non-negative-integer</code>, <code>positive-integer</code></li><li><code>boolean</code></li><li><code>date</code>, <code>date-time</code>, <code>date-with-timezone</code>, <code>date-time-with-timezone</code></li><li><code>day-time-duration</code>, <code>year-month-duration</code></li><li><code>base64</code>, <code>email-address</code>, <code>hostname</code>, <code>ip-v4-address</code>, <code>ip-v6-address</code></li></ul><p><strong>Markup types:</strong></p><ul><li><code>markup-line</code> (inline markup)</li><li><code>markup-multiline</code> (block-level markup)</li></ul><p><strong>Reference</strong>: <a href=/specification/datatypes/>Data Types Specification</a></p><hr><h2 id=10-implementation><a href=#10-implementation>10. Implementation</a></h2><h3 id=grammar><a href=#grammar>Grammar</a></h3><p>The <a href=https://github.com/metaschema-framework/metaschema-java rel=external>reference implementation</a> and the Metapath specification uses an ANTLR-based grammar for parsing (<code>[Metapath10.g4](https://github.com/metaschema-framework/metaschema-java/blob/develop/core/src/main/antlr4/Metapath10.g4)</code>), derived from but distinct from XPath 3.1&rsquo;s grammar.</p><p><strong>Reference</strong>: <a href=https://github.com/metaschema-framework/metaschema-java/blob/develop/core/src/main/antlr4/Metapath10.g4 rel=external>Metapath10.g4</a></p><h3 id=available-implementations><a href=#available-implementations>Available Implementations</a></h3><ul><li><strong>Java</strong>: <a href=https://github.com/metaschema-framework/metaschema-java rel=external>Metaschema Java Tools</a> - Primary implementation</li><li><strong>XSLT</strong>: <a href=https://github.com/usnistgov/metaschema-xslt rel=external>Metaschema XSLT</a> - XSLT-based implementation</li><li><strong>Go</strong>: <a href=https://github.com/GoComply/metaschema rel=external>GoComply Metaschema</a> - Community implementation</li></ul><hr><h2 id=summary-comparison-table><a href=#summary-comparison-table>Summary Comparison Table</a></h2><table><thead><tr><th>Aspect</th><th>XPath 3.1</th><th>Metapath</th></tr></thead><tbody><tr><td><strong>Data Model</strong></td><td>XDM (7 node types)</td><td>Metaschema (flag, field, assembly)</td></tr><tr><td><strong>Format Support</strong></td><td>XML only</td><td>XML, JSON, YAML</td></tr><tr><td><strong>Primary Purpose</strong></td><td>XML querying/transformation</td><td>Metaschema constraint evaluation</td></tr><tr><td><strong>Function Library</strong></td><td>200+ functions</td><td>100+ implemented (core, array, map) + custom extensions</td></tr><tr><td><strong>Type System</strong></td><td>XSD types</td><td>Metaschema data types</td></tr><tr><td><strong>Constraint Integration</strong></td><td>External (Schematron, etc.)</td><td>Native</td></tr><tr><td><strong>Namespace Nodes</strong></td><td>Supported</td><td>Not applicable</td></tr><tr><td><strong>Text Nodes</strong></td><td>Supported</td><td>Not applicable</td></tr><tr><td><strong>Attribute Syntax</strong></td><td><code>@attribute</code></td><td><code>@flag</code> (same syntax)</td></tr><tr><td><strong>Specification Status</strong></td><td>W3C Recommendation</td><td>Metaschema Framework specification (evolving)</td></tr></tbody></table><hr><h2 id=references><a href=#references>References</a></h2><ol><li><a href=../metapath/>Metapath Expression Language Specification</a></li><li><a href=https://www.w3.org/TR/2017/REC-xpath-31-20170321/ rel=external>XPath 3.1 W3C Recommendation</a></li><li><a href=/specification/>Metaschema Specification</a></li><li><a href=https://github.com/metaschema-framework/metaschema-java rel=external>Metaschema Java Tools</a></li><li><a href=/specification/information-modeling/>Information Modeling Specification</a></li><li><a href=../constraints/>Constraints Specification</a></li><li><a href=/specification/datatypes/>Data Types Specification</a></li><li><a href=https://github.com/metaschema-framework/metaschema rel=external>GitHub: metaschema-framework/metaschema</a></li><li><a href=https://github.com/metaschema-framework/metaschema-java rel=external>GitHub: metaschema-framework/metaschema-java</a></li><li><a href=https://www.w3.org/TR/xpath-datamodel-31/ rel=external>XPath and XQuery Data Model 3.1</a></li><li><a href=https://github.com/metaschema-framework/metaschema-java/blob/develop/core/src/main/antlr4/Metapath10.g4 rel=external>Metapath10.g4 Grammar</a></li><li><a href=https://github.com/metaschema-framework/metaschema-java/blob/develop/core/src/main/java/gov/nist/secauto/metaschema/core/metapath/cst/BuildCSTVisitor.java rel=external>BuildCSTVisitor.java</a></li><li><a href=https://github.com/metaschema-framework/metaschema-java/blob/develop/core/src/main/java/gov/nist/secauto/metaschema/core/metapath/function/library/DefaultFunctionLibrary.java rel=external>DefaultFunctionLibrary.java</a></li></ol></main></div></div><p class="font-sans-sm text-center" style="margin:1.5rem auto;clear:both">This page was last updated on December 10, 2025. <a href=https://github.com/metaschema-framework/metaschema/tree/master/website/content/specification/syntax/metapath-overview.md>Improve this Page.</a></p><script type=text/javascript src=/module/hugo-uswds/js/uswds.min.js></script><script>$(document).ready(function(){$('a[href*="//"]:not([href*="https://framework.metaschema.dev/"]):not([href^="#"]):not([href^="/"])').addClass("usa-link usa-link--external")})</script></body></html>