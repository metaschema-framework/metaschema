<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><script type=text/javascript src=/module/hugo-uswds/js/uswds-init.min.js></script><link rel=preload href=/module/hugo-uswds/js/uswds.min.js as=script><link rel=stylesheet href=/module/hugo-uswds/css/styles.css><title>Metapath Expression Language</title>
<script type=text/javascript src=/module/hugo-uswds/js/jquery.min.js></script><script type=text/javascript defer src=/module/hugo-uswds/js/hugo-uswds.min.js></script></head><body><div class=usa-overlay></div><header class="usa-header usa-header--extended site-header"><div class="usa-navbar site-header__navbar"><div id=extended-logo class="usa-logo site-logo"><a class="usa-logo__text site-logo__text" href=/ title="Metaschema Information Modeling Framework" aria-label=Home><em><span class=site-title--short>Metaschema</span>
<span class=site-title--long>Metaschema Information Modeling Framework</span></em></a></div><div class="site-nav-secondary usa-nav__secondary"><ul class=usa-nav__secondary-links><li class=usa-nav__secondary-item><a href=/contribute/contact/>Contact Us</a></li><li class=usa-nav__secondary-item><a href=/contribute/>Get involved</a></li><li class=usa-nav__secondary-item><a href=https://github.com/metaschema-framework/metaschema>Github</a></li></ul><section aria-label="Search component"><form class="usa-search usa-search--small" role=search action=https://search.usa.gov/search><input id=affiliate name=affiliate type=hidden>
<input name=utf8 type=hidden value=&#x2713;>
<label class=usa-sr-only for=search-field-en-small>Search</label>
<input class=usa-input id=search-field-en-small type=search name=query>
<button class=usa-button type=submit><img src=/module/hugo-uswds/img/usa-icons-bg/search--white.svg class=usa-search__submit-icon alt=Search></button></form></section></div><button class=usa-menu-btn>Menu</button></div></header><nav class="site-nav usa-nav sticky" aria-label="Primary navigation"><div class="usa-nav__inner site-nav__inner"><button class=usa-nav__close><img src=/module/hugo-uswds/img/usa-icons/close.svg role=img alt=close></button><ul class="usa-nav__primary usa-accordion"><li class=usa-nav__primary-item><a class=usa-nav__link href=/specification/><span>Specification</span></a></li><li class=usa-nav__primary-item><a class=usa-nav__link href=/tutorials/><span>Tutorials</span></a></li><li class=usa-nav__primary-item><a class=usa-nav__link href=/use/><span>Using</span></a></li><li class=usa-nav__primary-item><a class=usa-nav__link href=/contribute/><span>Contribute</span></a></li></ul></div></nav><div class=site-content-container><aside id=page-side-navigation class="sidenav site-sidenav" aria-label="Section navigation"><nav aria-label="Secondary navigation"><ul class=usa-sidenav><li class="usa-sidenav__item section usa-subnav__top-level"><a href=/specification/>Metaschema Specification</a><ul class=usa-sidenav__sublist><li class="usa-sidenav__item page"><a href=/specification/overview/>Overview</a></li><li class="usa-sidenav__item page"><a href=/specification/information-modeling/>Information Modeling</a></li><li class="usa-sidenav__item section"><a href=/specification/syntax/>Syntax</a><ul class=usa-sidenav__sublist><li class="usa-sidenav__item page"><a href=/specification/syntax/module/>Module</a></li><li class="usa-sidenav__item page"><a href=/specification/syntax/definitions/>Definitions</a></li><li class="usa-sidenav__item page"><a href=/specification/syntax/instances/>Instances</a></li><li class="usa-sidenav__item page"><a href=/specification/syntax/inline-definitions/>Inline Definitions</a></li><li class="usa-sidenav__item page"><a href=/specification/syntax/constraints/>Constraints</a></li><li class="usa-sidenav__item page"><a class=usa-current href=/specification/syntax/metapath/>Metapath Expression Language</a></li><li class="usa-sidenav__item page"><a href=/specification/syntax/metapath-overview/>Metapath vs. XPath</a></li></ul></li><li class="usa-sidenav__item page"><a href=/specification/mapping/>Format Bindings</a></li><li class="usa-sidenav__item page"><a href=/specification/datatypes/>Data Types</a></li><li class="usa-sidenav__item page"><a href=/specification/glossary/>Glossary</a></li></ul></li></ul></nav></aside><div class=usa-in-page-nav-container><aside class=site-in-page-nav aria-label="On this page" data-heading-selectors="h2, h3, h4, h5, h6" data-scroll-offset=-120 data-root-margin="48px 0px -90% 0px" data-threshold=1><nav class=usa-in-page-nav__nav aria-label="On this page"><h4 class=usa-in-page-nav__heading tabindex=0>On this page</h4><ul class=usa-in-page-nav__list><li class=usa-in-page-nav__item><a href=#data-model class="site-in-page-nav__link h2">Data Model</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#node-types class="site-in-page-nav__link h3">Node Types</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#format-agnostic-querying class="site-in-page-nav__link h3">Format-Agnostic Querying</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#node-identity class="site-in-page-nav__link h3">Node Identity</a></li><li class=usa-in-page-nav__item><a href=#syntax-overview class="site-in-page-nav__link h2">Syntax Overview</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#path-expressions class="site-in-page-nav__link h3">Path Expressions</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#predicates class="site-in-page-nav__link h3">Predicates</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#operators class="site-in-page-nav__link h3">Operators</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#comparison-operators class="site-in-page-nav__link h4">Comparison Operators</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#logical-operators class="site-in-page-nav__link h4">Logical Operators</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#arithmetic-operators class="site-in-page-nav__link h4">Arithmetic Operators</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#sequence-operators class="site-in-page-nav__link h3">Sequence Operators</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#conditional-expressions class="site-in-page-nav__link h3">Conditional Expressions</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#variable-references class="site-in-page-nav__link h3">Variable References</a></li><li class=usa-in-page-nav__item><a href=#evaluation-context class="site-in-page-nav__link h2">Evaluation Context</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#focus-node class="site-in-page-nav__link h3">Focus Node</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#dynamic-context class="site-in-page-nav__link h3">Dynamic Context</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#evaluation-in-constraints class="site-in-page-nav__link h3">Evaluation in Constraints</a></li><li class=usa-in-page-nav__item><a href=#built-in-functions class="site-in-page-nav__link h2">Built-in Functions</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#node-functions class="site-in-page-nav__link h3">Node Functions</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#string-functions class="site-in-page-nav__link h3">String Functions</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#numeric-functions class="site-in-page-nav__link h3">Numeric Functions</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#boolean-functions class="site-in-page-nav__link h3">Boolean Functions</a></li><li class=usa-in-page-nav__item><a href=#differences-from-xpath-31 class="site-in-page-nav__link h2">Differences from XPath 3.1</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#data-model-differences class="site-in-page-nav__link h3">Data Model Differences</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#unsupported-features class="site-in-page-nav__link h3">Unsupported Features</a></li><li class="usa-in-page-nav__item usa-in-page-nav__item--sub-item"><a href=#extended-features class="site-in-page-nav__link h3">Extended Features</a></li><li class=usa-in-page-nav__item><a href=#use-in-constraints class="site-in-page-nav__link h2">Use in Constraints</a></li></ul></nav></aside><main id=main-content class="main-content usa-prose"><header><nav class=usa-breadcrumb aria-label=Breadcrumbs><ol class=usa-breadcrumb__list><li class=usa-breadcrumb__list-item><a href=/specification/ class=usa-breadcrumb__link><span>Metaschema Specification</span></a></li><li class=usa-breadcrumb__list-item><a href=/specification/syntax/ class=usa-breadcrumb__link><span>Syntax</span></a></li><li class="usa-breadcrumb__list-item usa-current"><a href=/specification/syntax/metapath/ class=usa-breadcrumb__link aria-current=page><span>Metapath Expression Language</span></a></li></ol></nav></header><h1 id=metapath-expression-language><a href=#metapath-expression-language>Metapath Expression Language</a></h1><p>Metaschema includes support for an expression language called <em>Metapath</em>, which allows for selecting and evaluating Metaschema modules and data instances that conform to a Metaschema module. A Metapath can be used to query all Metaschema-supported formats (i.e., JSON, YAML, XML) using a common, Metaschema module-bound syntax. This means a Metapath can be used to query the same data regardless of the underlying format used, as long as that data is bound to a Metaschema module. This provides consistent portability of Metapath expressions against multiple serialization forms for the same data set.</p><p>Metapath is a customization of the <a href=https://www.w3.org/TR/2017/REC-xpath-31-20170321/ rel=external>XML Path Language (XPath) 3.1</a>, which has been adjusted to work with a Metaschema module-based model. This means the underlying <a href=https://www.w3.org/TR/xpath-datamodel-31/ rel=external>XML Data model</a> used by XPath, which exposes element and attribute nodes, is replaced with the Metaschema data model, which exposes flag, field, and assembly nodes.</p><p>XPath was chosen as a basis for Metapath because it provides for both <em>selection</em> of nodes and logical <em>evaluation</em> of node values, the latter of which is required for supporting Metaschema module <a href=/specification/syntax/constraints/>constraints</a>. Other path languages (e.g., <a href=https://goessner.net/articles/JsonPath/ rel=external>JSON Path</a>, <a href=https://www.rfc-editor.org/rfc/rfc6901.html rel=external>JSON Pointer</a>) were not chosen, due to limitations in <em>evaluation</em> capabilities and because their syntax was specific to JSON.</p><h2 id=data-model><a href=#data-model>Data Model</a></h2><p>Metapath operates on the Metaschema data model, which differs from XPath&rsquo;s XML-based data model.</p><h3 id=node-types><a href=#node-types>Node Types</a></h3><p>The Metaschema data model exposes the following node types:</p><table><thead><tr><th>Node Type</th><th>Description</th><th>XPath Equivalent</th></tr></thead><tbody><tr><td>Document</td><td>The root of a document instance</td><td>Document node</td></tr><tr><td>Assembly</td><td>A complex container with child content (flags and model items)</td><td>Element node</td></tr><tr><td>Field</td><td>A named value with optional flags</td><td>Element node</td></tr><tr><td>Flag</td><td>A simple name/value pair</td><td>Attribute node</td></tr></tbody></table><p>Unlike XPath&rsquo;s element/attribute distinction, Metaschema uses assembly/field/flag to represent the hierarchical structure of data. This abstraction allows Metapath expressions to work consistently across JSON, YAML, and XML representations of the same data.</p><h3 id=format-agnostic-querying><a href=#format-agnostic-querying>Format-Agnostic Querying</a></h3><p>The same Metapath expression queries equivalent data regardless of format. For example, the expression <code>/catalog/metadata/title</code> selects the title field from:</p><div id=tabs-0 class="codetabs usa-accordion"><ul><li class=codetab><button class=usa-accordion__button aria-expanded=true aria-controls=tabs-0-json-tab><span>JSON</span></button></li><li class=codetab><button class=usa-accordion__button aria-expanded=true aria-controls=tabs-0-yaml-tab><span>YAML</span></button></li><li class=codetab><button class=usa-accordion__button aria-expanded=true aria-controls=tabs-0-xml-tab><span>XML</span></button></li></ul><div id=tabs-0-content class=codetab-content><div id=tabs-0-json-tab class=codetab-content-item><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;catalog&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;metadata&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nt>&#34;title&#34;</span><span class=p>:</span> <span class=s2>&#34;Example Catalog&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div></div><div id=tabs-0-yaml-tab class=codetab-content-item><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>catalog</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>title</span><span class=p>:</span><span class=w> </span><span class=l>Example Catalog</span><span class=w>
</span></span></span></code></pre></div></div><div id=tabs-0-xml-tab class=codetab-content-item><div class=highlight><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;catalog&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;metadata&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;title&gt;</span>Example Catalog<span class=nt>&lt;/title&gt;</span>
</span></span><span class=line><span class=cl>  <span class=nt>&lt;/metadata&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/catalog&gt;</span>
</span></span></code></pre></div></div></div></div><p>This format independence is a key feature of Metapath, enabling validation rules and queries to be defined once and applied to any supported serialization format.</p><h3 id=node-identity><a href=#node-identity>Node Identity</a></h3><p>Each node in a Metaschema document instance has a unique identity. Two nodes are identical if and only if they represent the same node in the document tree.</p><h2 id=syntax-overview><a href=#syntax-overview>Syntax Overview</a></h2><p>Metapath expressions follow XPath 3.1 syntax with adaptations for the Metaschema data model.</p><h3 id=path-expressions><a href=#path-expressions>Path Expressions</a></h3><p>Path expressions select nodes from the document tree.</p><table><thead><tr><th>Syntax</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td><code>/</code></td><td>Absolute path from document root</td><td><code>/catalog/metadata</code></td></tr><tr><td><code>.</code></td><td>Current context node</td><td><code>.</code></td></tr><tr><td><code>..</code></td><td>Parent of current node</td><td><code>../sibling</code></td></tr><tr><td><code>name</code></td><td>Child with specified name</td><td><code>metadata</code></td></tr><tr><td><code>@name</code></td><td>Flag with specified name</td><td><code>@id</code></td></tr><tr><td><code>*</code></td><td>All child nodes</td><td><code>catalog/*</code></td></tr><tr><td><code>//</code></td><td>Descendant-or-self axis</td><td><code>//control</code></td></tr></tbody></table><h3 id=predicates><a href=#predicates>Predicates</a></h3><p>Predicates filter node sequences using conditions enclosed in square brackets.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>expression[predicate]
</span></span></code></pre></div><p>Examples:</p><ul><li><code>control[@id='ac-1']</code> - Select control with id flag equal to &lsquo;ac-1&rsquo;</li><li><code>param[1]</code> - Select the first param child</li><li><code>part[title]</code> - Select part children that have a title child</li></ul><h3 id=operators><a href=#operators>Operators</a></h3><h4 id=comparison-operators><a href=#comparison-operators>Comparison Operators</a></h4><table><thead><tr><th>Operator</th><th>Description</th></tr></thead><tbody><tr><td><code>=</code></td><td>Equal</td></tr><tr><td><code>!=</code></td><td>Not equal</td></tr><tr><td><code>&lt;</code></td><td>Less than</td></tr><tr><td><code>></code></td><td>Greater than</td></tr><tr><td><code>&lt;=</code></td><td>Less than or equal</td></tr><tr><td><code>>=</code></td><td>Greater than or equal</td></tr><tr><td><code>eq</code></td><td>Value equality</td></tr><tr><td><code>ne</code></td><td>Value inequality</td></tr><tr><td><code>lt</code></td><td>Value less than</td></tr><tr><td><code>gt</code></td><td>Value greater than</td></tr><tr><td><code>le</code></td><td>Value less than or equal</td></tr><tr><td><code>ge</code></td><td>Value greater than or equal</td></tr></tbody></table><h4 id=logical-operators><a href=#logical-operators>Logical Operators</a></h4><table><thead><tr><th>Operator</th><th>Description</th></tr></thead><tbody><tr><td><code>and</code></td><td>Logical AND</td></tr><tr><td><code>or</code></td><td>Logical OR</td></tr></tbody></table><p>The <code>not()</code> function provides logical negation.</p><h4 id=arithmetic-operators><a href=#arithmetic-operators>Arithmetic Operators</a></h4><table><thead><tr><th>Operator</th><th>Description</th></tr></thead><tbody><tr><td><code>+</code></td><td>Addition</td></tr><tr><td><code>-</code></td><td>Subtraction</td></tr><tr><td><code>*</code></td><td>Multiplication</td></tr><tr><td><code>div</code></td><td>Division</td></tr><tr><td><code>idiv</code></td><td>Integer division</td></tr><tr><td><code>mod</code></td><td>Modulus (remainder)</td></tr></tbody></table><h3 id=sequence-operators><a href=#sequence-operators>Sequence Operators</a></h3><table><thead><tr><th>Operator</th><th>Description</th></tr></thead><tbody><tr><td><code>,</code></td><td>Sequence concatenation</td></tr><tr><td><code>|</code></td><td>Sequence union</td></tr></tbody></table><h3 id=conditional-expressions><a href=#conditional-expressions>Conditional Expressions</a></h3><p>Metapath supports conditional expressions:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>if (condition) then expression1 else expression2
</span></span></code></pre></div><p>Example:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>if (count(./memory) &gt; 0) then sum(./memory/byte-size) else 0
</span></span></code></pre></div><h3 id=variable-references><a href=#variable-references>Variable References</a></h3><p>Variables are referenced using the <code>$</code> prefix:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>$variablename
</span></span></code></pre></div><p>Variables are bound using <a href=/specification/syntax/constraints/#let><code>&lt;let></code></a> declarations in constraints.</p><h2 id=evaluation-context><a href=#evaluation-context>Evaluation Context</a></h2><p>When a Metapath expression is evaluated, it operates within an <em>evaluation context</em> that determines how the expression is interpreted.</p><h3 id=focus-node><a href=#focus-node>Focus Node</a></h3><p>The <em>focus node</em> (also called <em>context node</em> or <em>evaluation focus</em>) is the node against which the expression is evaluated. Path expressions are resolved relative to this node.</p><ul><li>The context item <code>.</code> refers to the current focus node</li><li>Relative paths navigate from the focus node</li><li>The parent axis <code>..</code> navigates to the focus node&rsquo;s parent</li></ul><h3 id=dynamic-context><a href=#dynamic-context>Dynamic Context</a></h3><p>The dynamic context includes:</p><ul><li><strong>Context item</strong>: The current focus node</li><li><strong>Context position</strong>: The position of the context item within a sequence (1-based)</li><li><strong>Context size</strong>: The total number of items in the current sequence</li><li><strong>Variable bindings</strong>: Values bound to variables via <code>&lt;let></code> declarations</li><li><strong>Current date and time</strong>: The current timestamp for date/time functions</li></ul><h3 id=evaluation-in-constraints><a href=#evaluation-in-constraints>Evaluation in Constraints</a></h3><p>When Metapath expressions are used in <a href=/specification/syntax/constraints/>constraints</a>, the evaluation context varies by attribute:</p><table><thead><tr><th>Attribute</th><th>Focus Node</th></tr></thead><tbody><tr><td><code>@target</code></td><td>The content node associated with the definition where the constraint is declared</td></tr><tr><td><code>@test</code></td><td>Each node selected by the <code>@target</code> expression, evaluated in sequence</td></tr><tr><td><code>@expression</code> (in <code>&lt;let></code>)</td><td>The current node in the constraint evaluation context</td></tr><tr><td><code>&lt;message></code> templates</td><td>The failing target node</td></tr></tbody></table><p>For detailed constraint evaluation semantics, see <a href=/specification/syntax/constraints/#constraint-processing>Constraint Processing</a>.</p><h2 id=built-in-functions><a href=#built-in-functions>Built-in Functions</a></h2><p>Metapath provides a library of built-in functions. Functions may have zero, one, or multiple arguments. Functions are called using the syntax:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>function-name()
</span></span><span class=line><span class=cl>function-name(argument)
</span></span><span class=line><span class=cl>function-name(argument1, argument2, ...)
</span></span></code></pre></div><h3 id=node-functions><a href=#node-functions>Node Functions</a></h3><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>count(sequence)</code></td><td>Returns the number of items in a sequence</td></tr><tr><td><code>exists(sequence)</code></td><td>Returns <code>true</code> if the sequence is non-empty</td></tr><tr><td><code>empty(sequence)</code></td><td>Returns <code>true</code> if the sequence is empty</td></tr><tr><td><code>head(sequence)</code></td><td>Returns the first item in a sequence</td></tr><tr><td><code>tail(sequence)</code></td><td>Returns all items except the first</td></tr></tbody></table><h3 id=string-functions><a href=#string-functions>String Functions</a></h3><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>string(item)</code></td><td>Converts an item to a string</td></tr><tr><td><code>concat(string, string, ...)</code></td><td>Concatenates strings</td></tr><tr><td><code>starts-with(string, prefix)</code></td><td>Tests if string starts with prefix</td></tr><tr><td><code>ends-with(string, suffix)</code></td><td>Tests if string ends with suffix</td></tr><tr><td><code>contains(string, substring)</code></td><td>Tests if string contains substring</td></tr><tr><td><code>substring(string, start, length?)</code></td><td>Extracts a substring</td></tr><tr><td><code>string-length(string)</code></td><td>Returns the length of a string</td></tr><tr><td><code>normalize-space(string)</code></td><td>Normalizes whitespace</td></tr><tr><td><code>upper-case(string)</code></td><td>Converts to uppercase</td></tr><tr><td><code>lower-case(string)</code></td><td>Converts to lowercase</td></tr></tbody></table><h3 id=numeric-functions><a href=#numeric-functions>Numeric Functions</a></h3><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>sum(sequence)</code></td><td>Returns the sum of numeric values</td></tr><tr><td><code>avg(sequence)</code></td><td>Returns the average of numeric values</td></tr><tr><td><code>min(sequence)</code></td><td>Returns the minimum value</td></tr><tr><td><code>max(sequence)</code></td><td>Returns the maximum value</td></tr><tr><td><code>round(number)</code></td><td>Rounds to the nearest integer</td></tr><tr><td><code>floor(number)</code></td><td>Rounds down to an integer</td></tr><tr><td><code>ceiling(number)</code></td><td>Rounds up to an integer</td></tr><tr><td><code>abs(number)</code></td><td>Returns the absolute value</td></tr></tbody></table><h3 id=boolean-functions><a href=#boolean-functions>Boolean Functions</a></h3><table><thead><tr><th>Function</th><th>Description</th></tr></thead><tbody><tr><td><code>true()</code></td><td>Returns boolean <code>true</code></td></tr><tr><td><code>false()</code></td><td>Returns boolean <code>false</code></td></tr><tr><td><code>not(boolean)</code></td><td>Negates a boolean value</td></tr><tr><td><code>boolean(item)</code></td><td>Converts an item to a boolean</td></tr></tbody></table><h2 id=differences-from-xpath-31><a href=#differences-from-xpath-31>Differences from XPath 3.1</a></h2><p>While Metapath is based on XPath 3.1, there are notable differences:</p><h3 id=data-model-differences><a href=#data-model-differences>Data Model Differences</a></h3><ol><li><strong>Node types</strong>: Metapath uses assembly/field/flag instead of element/attribute</li><li><strong>Format independence</strong>: Expressions work across JSON, YAML, and XML representations</li><li><strong>Module binding</strong>: Expressions are interpreted in the context of a Metaschema module</li></ol><h3 id=unsupported-features><a href=#unsupported-features>Unsupported Features</a></h3><p>The following XPath 3.1 features are not currently supported in Metapath:</p><ul><li>Namespace axis and namespace nodes</li><li>Processing instruction nodes</li><li>Comment nodes</li><li>Some advanced XPath functions (consult implementation documentation)</li></ul><h3 id=extended-features><a href=#extended-features>Extended Features</a></h3><p>Metapath extends XPath with:</p><ul><li>Format-agnostic path expressions</li><li>Integration with Metaschema constraints</li><li>Template expressions in constraint messages using <code>{expression}</code> syntax</li></ul><h2 id=use-in-constraints><a href=#use-in-constraints>Use in Constraints</a></h2><p>Metapath expressions are primarily used in <a href=/specification/syntax/constraints/>Metaschema constraints</a> for:</p><table><thead><tr><th>Purpose</th><th>Attribute/Element</th><th>Example</th></tr></thead><tbody><tr><td>Target selection</td><td><code>@target</code></td><td><code>target="./child-field"</code></td></tr><tr><td>Condition testing</td><td><code>@test</code></td><td><code>test="count(.) > 0"</code></td></tr><tr><td>Variable binding</td><td><code>@expression</code></td><td><code>expression="ancestor::assembly/@id"</code></td></tr><tr><td><a href=/specification/syntax/constraints/#constraint-messages>Message templates</a></td><td><code>&lt;message></code></td><td><code>Value {.} is invalid</code></td></tr></tbody></table><p>For comprehensive constraint documentation, see <a href=/specification/syntax/constraints/>Constraints</a>.</p><p>For detailed information about how Metapath differs from XPath 3.1, including supported features, function library, and data model differences, see <a href=../metapath-overview/>Metapath vs. XPath 3.1: Key Differences</a>.</p></main></div></div><p class="font-sans-sm text-center" style="margin:1.5rem auto;clear:both">This page was last updated on December 10, 2025. <a href=https://github.com/metaschema-framework/metaschema/tree/master/website/content/specification/syntax/metapath.md>Improve this Page.</a></p><script type=text/javascript src=/module/hugo-uswds/js/uswds.min.js></script><script>$(document).ready(function(){$('a[href*="//"]:not([href*="https://framework.metaschema.dev/"]):not([href^="#"]):not([href^="/"])').addClass("usa-link usa-link--external")})</script></body></html>